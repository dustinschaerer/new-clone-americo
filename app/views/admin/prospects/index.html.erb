<!-- Page Heading -->
<div class="row">
    <div class="col-lg-12">
    	<ol class="breadcrumb">
            <li>
                <i class="fa fa-dashboard"></i>  <a href="/admin">Dashboard</a>
            </li>
            <li class="active">
                <i class="fa fa-bullhorn"></i> Prospects
            </li>
        </ol>
        <h1 class="page-header">Prospects</h1>
    </div>
</div>
<!-- /.row -->


<%= bootstrap_form_for(@prospect, url: admin_prospects_path, layout: :inline) do |f| %>
  <%= f.alert_message "Please fix the following errors:" %>
  <%= f.email_field :email, :placeholder => "Enter Email", :required => true, hide_label: true, input_html: { maxlength: 140 }  %>
  <%= f.text_field :name, :placeholder => "Enter Name", hide_label: true, input_html: { maxlength: 100 }  %>

  <%=
   #f.collection_select(:prospect_group_id, @prospect_groups, :id, :name, {:selected => "1", hide_label: true } )
   %>

  <%= f.form_group do %>
    <%= f.submit "Add New Prospect", class: "btn btn-primary"  %>
  <% end %>
<% end -%>

<%= paginate @prospects %>

<div class="row">
  <div class="no-more-tables">
    <%= bootstrap_form_tag url: assign_groups_for_admin_prospects_url, method: :patch do |f| %>
      <table class="col-md-12 table table-hover table-striped">
        <thead>
            <tr>
              <th></th>
              <th>Prospect ID</th>
              <th>Prospect Group</th>
              <th>Email</th>
              <th>Name</th>
              <th>Subscribed?</th>
              <th>Validated</th>
              <th>Date Joined On</th>
              <th>Active?</th>
            </tr>
        </thead>

        <tbody>
          <% @prospects.each do |prospect| %>
            <tr>
                <td data-title="">
                  <%= check_box_tag "prospect_ids[]", prospect.id %>
                </td>
                <td data-title="Prospect Id">
                  <%= link_to "#{prospect.id}", [:admin, prospect], class: "prospect-link" %>
                </td>
                <td data-title="Prospect Group ID">
                  <% if prospect.prospect_group %>
                    <a href="<%= "/admin/prospect_groups/#{prospect.prospect_group.id}" %>"><%= prospect.prospect_group_id %> - <%= prospect.prospect_group.name %></a>
                  <% else %>
                    Not Assigned
                  <% end %>
                </td>
                <td data-title="Email"><%= prospect.email %></td>
                <td data-title="Name"><%= prospect.name %></td>
                <td data-title="Unsubscribed"><%= prospect.subscribed %></td>
                <td data-title="Validated"><%= prospect.validated %></td>
                <td data-title="Date Joined On"><%= prospect.date_joined_on %></td>
                <td data-title="Active">
                  <% if prospect.active? %>
                    <span class="active_prospect"><%= prospect.active %></span>
                  <% else %>
                    <span class="inactive_prospect"><%= prospect.active %></span>
                  <% end %>
                </td>

            </tr>
          <% end  %>
        </tbody>
      </table>
      <br>
      <hr>
      <div class="form-group col-md-4">
        <p>Add Prospects to this Prospect Group:</p>
        <%= collection_select :prospect_group, :id, ProspectGroup.all, :id, :name, { prompt: "Please Choose" }, {class: "form-control"} %>
      </div>
      <div class="col-md-4">
        <p>&nbsp;</p>
        <%= submit_tag "Assign Checked to selected Prospect Group", class: "btn btn-primary" %>
      </div>

    <% end %>
  </div>
</div>
<!-- /.row -->

<%= paginate @prospects %>
<hr>
<div class="row">
  <div class="col-lg-12">
    <h3>Actions to Perform on All Prospects <i>(Warning: This cannot be undone!)</i></h3>
    <%= button_to 'Add Unsorted Prospects Into Prosepct Groups', add_unsorted_propsects_into_new_groups_admin_prospect_groups_path, class: "btn btn-warning", method: :get %>
  </div>
</div>